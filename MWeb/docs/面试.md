# 面试
## 自我介绍
你好我是本次一面面试官，很高兴你能来参加这次面试，希望在接下来的时间里，我们都能有一次非常愉快的交流。那么，首先，请你简单的介绍下自己。


熟悉直播业务

前三年
组件、IM、

16 滴滴
组件化建设

17
重构

18
0-1 优化整个地图体验，搭建引擎，指标建设、优化，架构升级 sdk -> 组件化
组建分层：

内存优化：基础数据结构、联合体、动画渲染、粗磨、segment、桢率。
40 - 60 
cpu使用率
地图核心体验：1s轮巡，司机3s，最大7s，提高轮巡频率（有瓶颈）
预测机制
速度加速 - 速度&加速度
偏航


组件化
项目流程
优化

## 基础知识
好的，接下来我问些iOS的基础知识



### 属性修饰符有哪些?说说区别？
atomic一定安全吗，atomic做了什么
什么时候用copy，不用copy会有什么问题

### 什么是KVC，KVO？KVO底层实现原理？，如果让你自己设计一套KVO，你会怎么做？
set 方法没有，监听不到
### 谈谈你对OC动态性的理解？
消息转发

如何发送消息的？开发过程中有哪些应⽤？
从Load和Initializer来进⾏分析 类、分类如何加载？

启动过程？（如果谈到了启动这一块，就问问）

### 解决循环引用？

    MRC __block & ARC __weak和unsafe_unretained
为什么 weak的可以解决循环引用，解决timer的强引用?
timer的循环引用，里面如果传递weakSelf还是无法释放，
>weakSelf和self指向地址空间一样，但实际上是不同的两个对象，两个对象同时持有，应该要处理引用计数，但实际上weakself没有处理引用计数，
block里面持有的是一个新的指针地址（weakSelf的指针地址和self的指针地址不一样），block实际并没有真正的持有self的指针空间
而timer里面runloop持有的是weakSelf的指针地址，而weakSelf的指针地址和self的地址实际是一样的。

block为什么要⽤copy？为什么不⽤retain?
block，weak底层实现分别是什么样的？
    三次coypy
weak表存在什么地方？
     -> SideTable 全局静态区

### layoutSubView何时调⽤？
1、初始化⽅法事不会调⽤
2、滚动UIScrollview触发
3、旋转屏幕时触发
4、改变View的值时候触发，前提是frame改变了
5、改变UIView的⼤⼩时触发


### 什么是Runloop？runloop和线程的关系？Runloop如何检测卡顿？图像是如何绘制的？

### iOS实现多线程的⽅式有哪些？
GCD和NSOperation, 如何选择？

```
dispatch_async(dispatch_get_global_queue(0, 0), ^{
        NSLog(@"1");
        [self performSelector:@selector(test) withObject:nil afterDelay:0];
        NSLog(@"2");
    });
    
- (void)test
{
    NSLog(@"3");
}

```



iOS线程同步的⼯具有哪些？

iOS有哪些锁?
[互斥锁（mutex）和 ⾃旋锁（Spin lock）两种锁适用于不同场景](https://www.jianshu.com/p/4b097aac2c9d)

野指针 for循环检查 
        多读单写（线程一直创建、销毁会导致崩溃） 
        数组存放的模型（模型类型用atomic） 数组copy 耗时时长
        atomic set @syncronize
        
        atomic什么时候使用atomic：数据调用频繁
        
        优化：
        分享优化：代码架构优化 
        卡顿优化：Instruments / Runloop 
        
        组件：
            rutor
            
            
        
        assign 悬挂指针
        
        avplyer 静态编译检查 debug graph 图， leak
        
        

### 常见crash？如何分析？

### 多媒体（视情况而定）
是否使⽤过CoreText或者CoreImage等？如果使⽤过，请谈谈你使⽤CoreText或者CoreImage的体验？
GPUImage的实现原理是什么？
iOS中有哪些动画


## 设计模式
⾯向对象六⼤原则？在实际中应用如何应用？
⾃⼰写过的组件或开源获官方中⽤到了哪些设计模式？
单例模式有什么缺点

## 项目
[直播原理](https://cloud.tencent.com/developer/article/1336240)

谈谈自己项目中优化的经验？具体的数据？
性能优化如何做？思路

项目重构？为什么重构？重构达标的标准？重构遇到的困难？如何解决？
为什么用MVVM，解决什么问题？带来什么问题？

优化：
如何检测性能？如何检测iOS内存问题？
Instrument Time Profile采集数据的两种⽅式？

如何优化iOS应⽤⽹络请求？
如何检测iOS卡顿并定位卡顿函数？

Dyld 加载的步骤
启动？造成APP启动过慢可能的原因有哪些？

组件化成功的标准？
什么才算⼀个好的架构？

图片缓存框架？

## 综合
说一个自己认为做得最好的项目，觉得自己是哪里做得好？
最近在学习什么技能？如何学习？
iOS上你最喜欢什么API？为什么？
wwdc20?

## 编码能力：

https://juejin.im/post/6844904038996279309

实现 pow(x, n) ，即计算 x 的 n 次幂函数。
说明:
-100.0 < x < 100.0
n 是 32 位有符号整数，其数值范围是 [−2^31, 2^31 − 1] 。

如何查找两个子视图的共同父视图？
```
- (NSArray<UIView *> *array)findSuperView:(UIView *)view {
    NSMutableArray *mArray = [NSMutableArray array];
    UIView *temp = [view superView];
    while(temp) {
        [mArray addObject:temp];
        temp = [temp superView];
    }
    return mArray;
}

- (NSArray<UIView *> *array)findCommonSuperView:(UIView *)view otherView:(UIView *)otherView {
    NSArray *viewSuperViews = [self findSuperView:view];
    NSArray *otherViewSuperViews = [self findSuperView:otherView];
    NSMutableArray *mResArray = [NSMutableArray array];
    int i = 0;
    int viewSuperViewCount = [viewSuperViews count];
    int otherViewSuperViewCount = [otherViewSuperViews count];
    //开始查找---> 倒序遍历,因为他们的最顶端的父视图肯定都是UIWindow
    while(i < fmin([viewSuperViews count], [otherViewSuperViews count])) {
        UIView super1 = viewSuperViews[otherViewSuperViewCount - i -1];
        UIView super2 = otherViewSuperViews[otherViewSuperViewCount - i - 1];
        if (super1 == super2) {
            [mResArray addObject:super1];
            i++;
        } else {
            break;
        }
    }
}
```

```
- (void)textDemo1{
    // 同步队列
    dispatch_queue_t queue = dispatch_queue_create("yoyo", DISPATCH_QUEUE_SERIAL);
    NSLog(@"1");
    dispatch_async(queue, ^{
        NSLog(@"2");
        dispatch_sync(queue, ^{
            NSLog(@"3");
        });
    });
    NSLog(@"4");
}

- (void)textDemo2{
    dispatch_queue_t queue = dispatch_queue_create("com.yoyo.cn", DISPATCH_QUEUE_CONCURRENT);
    dispatch_async(queue, ^{
        NSLog(@"1");
    });
    dispatch_async(queue, ^{
        NSLog(@"2");
    });
    dispatch_sync(queue, ^{
        NSLog(@"3");
    });
    // **********************
    NSLog(@"0");

    dispatch_async(queue, ^{
        NSLog(@"7");
    });
    dispatch_async(queue, ^{
        NSLog(@"8");
    });
    dispatch_async(queue, ^{
        NSLog(@"9");
    });
    
}

```

// A: 1230789
    // B: 3120798
    // C: 1237890
    // D: 2137890


## 提问环节？
有什么问题吗？

OpenGL


## 2020年10月最新
1
1、strong， copy; assign, weak
ARC是什么时期的特性？相对于MRC是如何达到优化的
__weak对象是何时被释放的？
autoreleasepool的底层实现原理及使⽤场景？
IBOutlet为什么要设置成weak、设置成strong⾏不⾏？

2、KVC、KVO？ KVC 使用场景，解决什么问题；KVO使用注意事项？设计？

KVO 封装设计思路

3、OC Class的载⼊过程？（从Load和Initializer来进⾏分析）
分类使用：



3、为什么在 Objective-C 中给 nil 发送消息程序不会崩溃？OC是如何响应⼀条消息的
简述⼀下OC 消息转发流程
说⼀说消息转发流程，你在开发过程中有哪些应⽤

4、对于Objective-C，你认为它最⼤的优点和最⼤的不⾜是什么？对于不⾜之处，如何绕过这些不⾜实现需求？
5、category的作⽤？优缺点有哪些？

6、extern的作⽤？static的作⽤？

7、 layoutSubView何时调⽤？
button没有被相应的原因
扩大Button相应范围？


多线程基础
多写单读的安全容器类 128

iOS异常有哪些异常？如何处理
iOS抛出异常的过程？


设计：
为什么要有元类？将类⽅法存在元类的好处?
单例和全局变量的区别
MVC与MVVM区别？
如何编写单元测试？比如写了一个网络库，用例怎么写得更全面

AVPlayer的坑？文件缓存如何设计？多个视频文件缓存？84-85

容错组件 120
iOS组件化架构方案 127
用户资料缓存系统 128



teq a1, #0
moveq a2, #0
bxeq lr
对应 objc_msgSend，第⼀个参数为 self，返回值也是 self，都放在 r0
moveq 指令说明：如果self为空，则将 selector 也设置为空。
bx 指令说明：
在 arm 中 bx lr ⽤来返回到调⽤⼦程序的地⽅（即：返回到调⽤者），此处是：如果 self 为空，就返回到调⽤
objc_msgSend 的地⽅继续执⾏。
总之：如果传递给 objc_msgSend 的 self 参数是 nil，该函数不会执⾏有意义的操作，直接返回





